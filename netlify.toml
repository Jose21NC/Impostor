[build]
  command = "npm run build"
  publish = "packages/client/dist"
  # Opcional: puedes definir una condición de ignorar builds usando un comando shell
  # Ejemplo (descomenta y ajusta si quieres que sólo reconstruya cuando cambie el cliente):
  # ignore = "bash -lc 'git diff --quiet $CACHED_COMMIT_REF $COMMIT_REF -- packages/client packages/shared'"

# Monorepo: aseguramos que Netlify ejecute en la raíz del repo
[build.environment]
  NODE_VERSION = "22"
  NPM_FLAGS = "--legacy-peer-deps"
  # Variables de ejemplo (usar el UI de Netlify para valores reales)
  VITE_SERVER_URL = "https://impostor-7iz7.onrender.com" # URL del servidor Socket.io externo (producción)
  VITE_YT_AMBIENT_VIDEO_ID = ""       # ID de YouTube para música ambiente opcional
  VITE_YT_DRUM_ID = ""                # ID para sonido de cuenta regresiva
  VITE_YT_APPLAUSE_ID = ""            # ID para aplausos
  VITE_YT_ROLE_REVEAL_CIVIL_ID = ""   # ID para reveal civil
  VITE_YT_ROLE_REVEAL_IMPOSTOR_ID = ""# ID para reveal impostor
  VITE_SOUND_AMBIENT_URL = ""         # URL directa a sonido ambiente (mp3/ogg)
  VITE_SOUND_DRUM_URL = ""            # URL directa a drum tick
  VITE_SOUND_APPLAUSE_URL = ""        # URL directa a aplausos
  VITE_SOUND_ROLE_REVEAL_URL = ""     # URL genérico de reveal
  VITE_SOUND_ROLE_REVEAL_CIVIL_URL = "" # URL reveal civil
  VITE_SOUND_ROLE_REVEAL_IMPOSTOR_URL = "" # URL reveal impostor

# Ignorar reconstrucción si sólo cambian archivos del servidor (no afecta cliente)
# Nota: La clave [build.ignore] con 'files' no es válida en Netlify. Usa la clave 'ignore' como string arriba si la necesitas.

# Headers para permitir WebSockets (aunque Netlify sólo sirve el cliente; el backend externo debe soportar CORS correctos)
[[headers]]
  for = "/assets/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

# Redirección SPA (todas las rutas al index.html)
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
